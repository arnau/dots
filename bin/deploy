#! /usr/bin/env ruby

require 'fileutils'

env = ARGV.shift
abort "Gimme an environment" if env.nil?

env = env.to_sym

environments = {
  vagrant: {
    dir: '/home/vagrant/.dots',
    manifest: 'vagrant.pp'
  }
}

FileUtils.cd(environments[env][:dir]) do
  system 'bundle install'
  system "bundle exec puppet apply --modulepath=#{environments[env][:dir]}/recipes/modules #{environments[env][:dir]}/recipes/manifests/#{environments[env][:manifest]}"
end

